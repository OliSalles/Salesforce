import { LightningElement, track } from 'lwc';
import sendDataToServer from '@salesforce/apex/DataMassController.sendDataToServer';

export default class DataCreator extends LightningElement {
    @track supervisor = '';
    @track acessor = '';
    @track operador = '';
    @track successMessage = '';

    handleInputChange(event) {
        const field = event.target.dataset.id;
        if (field === 'supervisor') {
            this.supervisor = event.target.value;
        } else if (field === 'acessor') {
            this.acessor = event.target.value;
        } else if (field === 'operador') {
            this.operador = event.target.value;
        }
    }

    handleSubmit() {
        const data = {
            supervisor: this.supervisor,
            acessor: this.acessor,
            operador: this.operador
        };

        sendDataToServer({ data: JSON.stringify(data) })
            .then(result => {
                // Handle success
                this.successMessage = 'Massa de dados criada com sucesso!';
                this.clearFields();
            })
            .catch(error => {
                // Handle error
                console.error('Error sending data:', error);
                this.successMessage = 'Erro ao criar massa de dados.';
            });
    }

    handleReset() {
        this.clearFields();
        this.successMessage = 'Campos resetados.';
    }

    clearFields() {
        this.supervisor = '';
        this.acessor = '';
        this.operador = '';
    }
}